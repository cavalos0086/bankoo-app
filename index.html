<html ng-app="bankooTest">
	<head>
		<script src="bower_components/angular/angular.min.js"></script>
		<script>
angular.module("bankooTest", [])
	.run(run)
	.controller("mainController", mainController);

function run(){
	if(window.PaymentRequest) {
		initPaymentRequestApi();
	} else {
		console.log("Payment Request Not Found");
	}

}

function initPaymentRequestApi() {

	var supportedInstruments = [
		{
			supportedMethods: ['basic-card'],
			data: {
				supportedNetworks: ['amex', 'discover', 'mastercard', 'visa']
			}
		},
		{
			supportedMethods: ['https://android.com/pay'],
			data: {
				//merchant ID obtained from Google that maps to your origin
				merchantId: '02510116604241796260',
				environment: 'TEST',
				// Credit Cards allowed via Android Pay
				allowedCardNetworks: ['AMEX', 'MASTERCARD', 'VISA', 'DISCOVER'],
				paymentMethodTokenizationParameters: {
					tokenizationType: 'GATEWAY_TOKEN',
					parameters: {
						'gateway': 'stripe',
						// Place your own Stripe publishable key here.
						'stripe:publishableKey': 'pk_live_fD7ggZCtrB0vJNApRX5TyJ9T',
						'stripe:version': '2016-07-06'
					}
				}
			}
		}
	];

			var paymentDetails = {
				total: {
					label: 'mechantName',
					amount: {
						currency: 'USD',
						value: '20',
					},
				},
			};

			window.paymentRequest = new window.PaymentRequest(supportedInstruments, paymentDetails);
		}

		function mainController($scope){
			var vm = this;
			vm.isSecureContext = window.isSecureContext;
			vm.handleClick = handleClick;
			vm.apiPresent = !!window.PaymentRequest;

			function handleError(err) {
				if(err.message === "Request cancelled"){
					vm.requestStatus = "Request Cancelled";
				}
			}

			function handleClick(e){
				window.paymentRequest.show()
					.then(handleResponse)
					.catch(handleError);
			}

			function handleResponse(checkoutResponse){
				alert(checkoutReponse);
				checkoutResponse.complete('success');
			}

		}
	</script>
	</head>
	<body ng-controller="mainController as vm">
		<h1>Is Secure Context {{vm.isSecureContext}}</h1>
		<h1>Api Present {{vm.apiPresent}}</h1>
		<h1 ng-show="vm.apiPresent">Can Make Payment {{vm.canMakePayment}}</h1>
		<button ng-click="vm.handleClick()">Send Request</button>
		<h1>{{vm.requestStatus}}</h1>
	</body>
</html>
